{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>{% block title %}{{ settings_obj.meta_title }}{% endblock %}</title>
<meta name="description" content="{{ settings_obj.meta_title }}">
<meta name="keywords" content="">
<link rel="icon" href="{{ settings_obj.favicon.url }}" type="image/png">
<link rel="apple-touch-icon" href="{{ settings_obj.favicon.url }}">
<script src="https://cdn.tailwindcss.com"></script>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/18.2.1/css/intlTelInput.css">
<link rel="stylesheet" href="{% static 'css/style.css' %}">
<style>
  .fixed-footer {
    position: fixed;
    bottom: 0;
    left: 0;
    width: 100%;

    background: #f3f4f6;
    color: #374151;
    font-size: 12px;

    text-align: center;
    padding: 8px 12px;

    border-top: 1px solid #e5e7eb;
    z-index: 999;
  }

  .fixed-footer strong {
    font-weight: 600;
  }

  .footer-links {
    margin-left: 8px;
  }

  .footer-links a {
    color: #2563eb;
    text-decoration: none;
    font-weight: 500;
  }

  .footer-links a:hover {
    text-decoration: underline;
  }

  .divider {
    margin: 0 6px;
    color: #9ca3af;
  }

  /* Mobile & Tablet */
  @media (max-width: 768px) {
    .fixed-footer {
      font-size: 11px;
      padding: 10px 8px;
    }
  }

  .iti--separate-dial-code .iti__selected-dial-code {
    margin-left: 8px;
  }
  .iti {
    width: 100%;
  }
  .iti input,
  .iti input[type=tel] {
    width: 100%;
    height: 44px;              /* üî• fix height */
    padding-left: 90px !important; /* üî• space for flag + code */
    padding-right: 12px;
    font-size: 14px;
    border-radius: 6px;
    border: 1px solid #d1d5db; /* gray-300 */
    outline: none;
  }
  .iti__flag-container {
    left: 8px;
  }
  .iti__selected-flag {
    height: 100%;
    padding: 0 8px;
    display: flex;
    align-items: center;
  }
  .iti__arrow {
    margin-left: 6px;
  }
  .iti input:focus {
    border-color: #fb923c; /* orange-400 */
    box-shadow: 0 0 0 2px rgba(251,146,60,0.3);
  }

</style>
</head>
<body>


{% include 'includes/header.html' %}

{% block content %}{% endblock %}



<div id="planRequestModal" class="fixed inset-0 bg-black/60 hidden z-50 flex items-center justify-center">

  <div class="bg-white w-[92%] max-w-md p-6 relative shadow-2xl">

    <button onclick="closePlanRequestModal()" class="absolute top-4 right-4 bg-gray-100 w-8 h-8 flex items-center justify-center">
      <i class="fa-solid fa-xmark"></i>
    </button>

    <div class="mb-6 pb-3 border-b-2 border-orange-400">
      <h3 class="text-lg font-bold text-gray-800">Request Floor Plan</h3>
      <p class="text-sm text-gray-500">For <span id="planTitle" class="font-semibold text-orange-600"></span></p>
    </div>

    <form onsubmit="return submitPlanRequest()" class="space-y-4">

      <input type="text" required placeholder="Full Name" class="w-full border px-3 py-2 text-sm">

      <input type="tel" required placeholder="Mobile Number"
        class="phone-input w-full border px-3 py-2 text-sm">

        <input type="tel" required placeholder="Email"
        class="phone-input w-full border px-3 py-2 text-sm">

      <button type="submit" class="w-full bg-orange-500 text-white py-3">Submit & View Plan</button>

    </form>

  </div>
</div>

<div id="configModal" class="fixed inset-0 bg-black/60 hidden z-50 flex items-center justify-center">
  <div class="bg-white w-[92%] max-w-md p-6 relative shadow-2xl">

    <button type="button" onclick="closeConfigModal()" class="absolute top-4 right-4 bg-gray-100 w-8 h-8 flex items-center justify-center hover:bg-gray-200">
      <i class="fa-solid fa-xmark"></i>
    </button>

    <div class="mb-6 pb-3 border-b-2 border-orange-400">
      <h3 class="text-lg font-bold text-gray-800">Get Configuration Details</h3>
      <p class="text-sm text-gray-500">For <span id="selectedBHK" class="text-orange-600 font-semibold">--</span></p>
    </div>

    <form method="post" action="{% url 'response:configuration' %}" class="space-y-4">
      {% csrf_token %}

      <input type="hidden" name="configuration" id="modalConfigInput">

      <input type="text" name="name" required placeholder="Full Name" class="w-full border px-3 py-2 text-sm">
      <input type="email" name="email" required placeholder="Email Address" class="w-full border px-3 py-2 text-sm">
      <input type="tel" name="phone" maxlength="10" required placeholder="Mobile Number" class="w-full border px-3 py-2 text-sm">

      <button type="submit" class="w-full bg-orange-500 text-white py-3 hover:bg-orange-600 transition">
        Submit & Get Details
      </button>
    </form>
  </div>
</div>

<div id="visitModal" class="fixed inset-0 bg-black/60 hidden z-50 flex items-center justify-center">

  <div class="bg-white w-[92%] max-w-md p-6 relative shadow-2xl">

    <button onclick="closeVisitModal()"
      class="absolute top-4 right-4 bg-gray-100 w-8 h-8 flex items-center justify-center">
      <i class="fa-solid fa-xmark"></i>
    </button>

    <h3 class="text-lg font-bold mb-4">Schedule Site Visit</h3>

     <form method="post" action="{% url 'response:additional_info' %}" class="space-y-4">
      {% csrf_token %}

      <input type="hidden" name="type" value="book_visit">

      <input type="text" name="name" placeholder="Full Name"
        class="w-full border px-3 py-2 text-sm" required>

      <input type="email" name="email" required placeholder="Email Address" class="w-full border px-3 py-2 text-sm">

      <input type="tel" name="phone" placeholder="Mobile Number"
        class="phone-input w-full border px-3 py-2 text-sm" required>

      <p class="phone-error text-red-500 text-xs hidden">
        Please enter a valid mobile number
      </p>

      <button class="w-full bg-orange-500 text-white py-3">
        Book Visit
      </button>
    </form>


  </div>
</div>

<!-- ===== GALLERY POPUP ===== -->
<div id="galleryPopup" class="fixed inset-0 bg-black/80 hidden z-[9999] flex items-center justify-center">

  <div class="absolute inset-0" onclick="closeGalleryPopup()"></div>

  <div class="relative w-full max-w-6xl px-4">

    <!-- Close -->
    <button onclick="closeGalleryPopup()" class="absolute -top-12 right-4 w-10 h-10 rounded-full bg-white shadow flex items-center justify-center text-gray-700 hover:bg-orange-500 hover:text-black transition">
      <i class="fa-solid fa-xmark"></i>
    </button>

    <!-- Image Box -->
    <div class="relative rounded-xl overflow-hidden">

      <img id="popupImage" src="" class="w-full max-h-[80vh] object-contain">

      <!-- Counter -->
      <div id="galleryCounter" class="absolute bottom-4 left-1/2 -translate-x-1/2 bg-black/90 text-gray-700 text-xs px-3 py-1 rounded-full shadow"></div>

      <!-- Prev -->
      <button onclick="prevImage()" class="absolute left-3 top-1/2 -translate-y-1/2 w-11 h-11 rounded-full bg-white shadow text-gray-700 flex items-center justify-center hover:bg-orange-500 hover:text-orange transition">
        <i class="fa-solid fa-chevron-left"></i>
      </button>

      <!-- Next -->
      <button onclick="nextImage()" class="absolute right-3 top-1/2 -translate-y-1/2 w-11 h-11 rounded-full bg-white shadow text-gray-700 flex items-center justify-center hover:bg-orange-500 hover:text-orange transition">
        <i class="fa-solid fa-chevron-right"></i>
      </button>

    </div>
  </div>
</div>
<!-- ===== END POPUP ===== -->

<div id="brochureModal" class="fixed inset-0 bg-black/60 hidden z-50 flex items-center justify-center">

  <div class="bg-white w-[92%] max-w-md p-6 relative rounded-xl shadow-xl">

   <button type="button" onclick="document.getElementById('brochureModal').classList.add('hidden')"
   class="absolute top-3 right-3 w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center">
   <i class="fa-solid fa-xmark"></i>
  </button>

    <h3 class="text-lg font-bold text-gray-900 mb-1">
      Download Brochure
    </h3>
    <p class="text-sm text-gray-600 mb-4">
      Please fill the details to download the brochure.
    </p>

       <div id="brochureFormWrapper">
        <form id="brochureForm" class="space-y-3">
          {% csrf_token %}
          <input type="hidden" name="project_id" value="{{ project.id }}">

          <input name="name" required placeholder="Full Name"
            class="w-full border px-3 py-2 text-sm rounded">

          <input name="email" type="email" required placeholder="Email Address"
            class="w-full border px-3 py-2 text-sm rounded">

          <input type="email" name="email" required placeholder="Email Address" class="w-full border px-3 py-2 text-sm">


          <input name="mobile" required placeholder="Mobile Number"
            class="w-full border px-3 py-2 text-sm rounded">

          <button type="submit"
            class="w-full bg-orange-500 text-white py-2 rounded-lg font-semibold">
            Download Brochure
          </button>
        </form>
      </div>



  </div>
</div>


<!-- THANK YOU MESSAGE -->
<div id="thankYouBox" class="hidden text-center py-6">
  <div class="text-green-600 text-3xl mb-3">‚úî</div>
  <h4 class="text-lg font-bold text-gray-900 mb-1">
    Thank You!
  </h4>
  <p class="text-sm text-gray-600">
    Our team will contact you shortly.
    <br>
    Your brochure download has started.
  </p>
</div>


<div id="priceModal" class="fixed inset-0 bg-black/60 hidden z-50 flex items-center justify-center">

  <div class="bg-white w-[92%] max-w-md p-6 relative shadow-2xl">

    <button onclick="closePriceModal()"
      class="absolute top-4 right-4 bg-gray-100 w-8 h-8 flex items-center justify-center">
      <i class="fa-solid fa-xmark"></i>
    </button>

    <h3 class="text-lg font-bold mb-4">Get Price Details</h3>

    <form method="post" action="{% url 'response:additional_info' %}" class="space-y-4">
      {% csrf_token %}

      <input type="hidden" name="type" value="get_price">

      <input type="text" name="name" placeholder="Full Name"
        class="w-full border px-3 py-2 text-sm" required>

      <input type="email" name="email" required placeholder="Email Address" class="w-full border px-3 py-2 text-sm">

      <input type="tel" name="phone" placeholder="Mobile Number"
        class="phone-input w-full border px-3 py-2 text-sm" required>

      
      <p class="phone-error text-red-500 text-xs hidden">
        Please enter a valid mobile number
      </p>


      <button class="w-full bg-orange-500 text-white py-3">
          Get Price
      </button>
    </form>


  </div>
</div>

<script>
window.closeBrochureModal = function () {
  document.getElementById("brochureModal").classList.add("hidden");
};

window.openBrochureModal = function () {
  document.getElementById("brochureModal").classList.remove("hidden");
};
</script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/18.2.1/js/intlTelInput.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/18.2.1/js/utils.js"></script>

<script>
  document.querySelectorAll(".phone-input").forEach(input => {
    const iti = window.intlTelInput(input, {
      initialCountry: "auto",
      separateDialCode: true,
      utilsScript: "https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/18.2.1/js/utils.js",
      geoIpLookup: cb => fetch("https://ipapi.co/json").then(r=>r.json()).then(d=>cb(d.country_code)).catch(()=>cb("IN"))
    });
  });
    document.querySelectorAll('.faq-btn').forEach(button => {
    button.addEventListener('click', () => {
      const item = button.closest('.faq-item');
      const content = item.querySelector('.faq-content');
      const icon = item.querySelector('.faq-icon i');

      // Close all other FAQs
      document.querySelectorAll('.faq-item').forEach(other => {
        if (other !== item) {
          other.querySelector('.faq-content').classList.add('hidden');
          other.querySelector('.faq-icon i').classList.remove('fa-minus');
          other.querySelector('.faq-icon i').classList.add('fa-plus');
        }
      });

      // Toggle current FAQ
      content.classList.toggle('hidden');
      icon.classList.toggle('fa-plus');
      icon.classList.toggle('fa-minus');
    });
  });
</script>

<script>
  function openVisitModal(){
    document.getElementById("visitModal").classList.remove("hidden");
  }
  function closeVisitModal(){
    document.getElementById("visitModal").classList.add("hidden");
  }

  function openPriceModal(){
    document.getElementById("priceModal").classList.remove("hidden");
  }
  function closePriceModal(){
    document.getElementById("priceModal").classList.add("hidden");
  }
</script>

<script>
document.addEventListener("DOMContentLoaded", function () {

  const form = document.getElementById("brochureForm");
  const formWrapper = document.getElementById("brochureFormWrapper");
  const thankYouBox = document.getElementById("thankYouBox");

  if (!form) return;

  form.addEventListener("submit", function(e) {
    e.preventDefault();

    const formData = new FormData(form);

    fetch("{% url 'response:brochure_lead' %}", {
      method: "POST",
      headers: {
        "X-CSRFToken": formData.get("csrfmiddlewaretoken")
      },
      body: formData
    })
    .then(res => res.json())
    .then(data => {
      if (data.status === "success") {

        // üîΩ Download brochure
        const link = document.createElement("a");
        link.href = "{{ rera.document.url }}";
        link.download = "";
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);

        // ‚úÖ SHOW THANK YOU
        formWrapper.classList.add("hidden");
        thankYouBox.classList.remove("hidden");

        // Auto close after 3 sec (optional)
        setTimeout(() => {
          document.getElementById("brochureModal").classList.add("hidden");
          form.reset();
          thankYouBox.classList.add("hidden");
          formWrapper.classList.remove("hidden");
        }, 3000);
      }
    });
  });

});
</script>


<script>
function openConfigModal(btn){
  // 1. Button se Data nikaalo
  const bhk = btn.getAttribute('data-bhk');
  
  // Debugging: Console check karein agar value na aaye
  console.log("Saving Configuration:", bhk);

  // 2. UI Update (Modal Text)
  document.getElementById("selectedBHK").innerText = bhk;

  // 3. Backend Input Update (Jo Hidden field hai)
  const hiddenInput = document.getElementById("modalConfigInput");
  if(hiddenInput){
      hiddenInput.value = bhk;
  }

  // 4. Modal Open
  document.getElementById("configModal").classList.remove("hidden");
}

function closeConfigModal(){
  document.getElementById("configModal").classList.add("hidden");
}
</script>

<script>
let itiInstances = [];

function initPhoneValidation() {
  itiInstances = [];

  document.querySelectorAll(".phone-input").forEach(input => {

    const iti = window.intlTelInput(input, {
      initialCountry: "auto",
      separateDialCode: true,
      nationalMode: false,
      utilsScript:
        "https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/18.2.1/js/utils.js",
      geoIpLookup: cb => {
        fetch("https://ipapi.co/json/")
          .then(res => res.json())
          .then(data => cb(data.country_code))
          .catch(() => cb("IN"));
      }
    });

    itiInstances.push({ input, iti });

    // live validation
    input.addEventListener("input", () => {
      validatePhoneInput(input, iti);
    });
  });
}

function validatePhoneInput(input, iti) {
  const errorEl = input.nextElementSibling;

  if (input.value.trim() === "") {
    errorEl.classList.add("hidden");
    return false;
  }

  if (iti.isValidNumber()) {
    errorEl.classList.add("hidden");
    input.classList.remove("border-red-500");
    return true;
  } else {
    errorEl.classList.remove("hidden");
    input.classList.add("border-red-500");
    return false;
  }
}

/* üî• FORM SUBMIT BLOCK */
document.querySelectorAll("form").forEach(form => {
  form.addEventListener("submit", function (e) {

    let valid = true;

    itiInstances.forEach(obj => {
      if (form.contains(obj.input)) {
        if (!validatePhoneInput(obj.input, obj.iti)) {
          valid = false;
        }
      }
    });

    if (!valid) {
      e.preventDefault(); // ‚ùå stop submit
    }
  });
});

/* init on load */
document.addEventListener("DOMContentLoaded", initPhoneValidation);
</script>

<script>
document.addEventListener("input", function (e) {
  if (e.target.classList.contains("phone-input")) {
    e.target.value = e.target.value.replace(/\D/g, "").slice(0, 10);
  }
});
</script>

<script>
let galleryImages = [];
let currentIndex = 0;

document.addEventListener("DOMContentLoaded", () => {

  // sirf actual gallery images lo
  document.querySelectorAll(
    '#gallerySlider img[data-gallery="true"]'
  ).forEach(img => {
    galleryImages.push(img.src);
  });

  console.log("Gallery Loaded:", galleryImages);
});

function openGalleryPopup(index) {
  if (!galleryImages.length) return;

  currentIndex = index;
  document.getElementById("popupImage").src =
    galleryImages[currentIndex];

  document.getElementById("galleryPopup")
    .classList.remove("hidden");

  document.body.style.overflow = "hidden";
}

function closeGalleryPopup() {
  document.getElementById("galleryPopup")
    .classList.add("hidden");

  document.body.style.overflow = "";
}

function nextImage() {
  currentIndex = (currentIndex + 1) % galleryImages.length;
  document.getElementById("popupImage").src =
    galleryImages[currentIndex];
}

function prevImage() {
  currentIndex =
    (currentIndex - 1 + galleryImages.length) % galleryImages.length;

  document.getElementById("popupImage").src =
    galleryImages[currentIndex];
}

// ESC key close
document.addEventListener("keydown", e => {
  if (e.key === "Escape") closeGalleryPopup();
});
</script>



<footer class="fixed-footer">
  ¬© 2026 <strong>{{settings_obj.copy_right}}</strong>. All rights reserved.
  <span class="footer-links">
    <a href="{% url 'privacy-policy' %}">Privacy Policy</a>
    <span class="divider">|</span>
    <a href="{% url 'terms_conditions' %}">Terms</a>
  </span>
</footer>



<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

</body>
</html>
