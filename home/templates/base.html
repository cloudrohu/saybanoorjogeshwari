{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>{% block title %}{{ settings_obj.meta_title }}{% endblock %}</title>
<meta name="description" content="{{ settings_obj.meta_title }}">
<meta name="keywords" content="">
<link rel="icon" href="{{ settings_obj.favicon.url }}" type="image/png">
<link rel="apple-touch-icon" href="{{ settings_obj.favicon.url }}">
<script src="https://cdn.tailwindcss.com"></script>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/18.2.1/css/intlTelInput.css">
<link rel="stylesheet" href="{% static 'css/style.css' %}">
<style>
  .iti--separate-dial-code .iti__selected-dial-code {
    margin-left: 8px;
  }/* ===============================
    INTL TEL INPUT ‚Äì CLEAN FIX
  ================================ */

  /* wrapper full width */
  .iti {
    width: 100%;
  }

  /* actual input */
  .iti input,
  .iti input[type=tel] {
    width: 100%;
    height: 44px;              /* üî• fix height */
    padding-left: 90px !important; /* üî• space for flag + code */
    padding-right: 12px;
    font-size: 14px;
    border-radius: 6px;
    border: 1px solid #d1d5db; /* gray-300 */
    outline: none;
  }

  /* flag container */
  .iti__flag-container {
    left: 8px;
  }

  /* country code box */
  .iti__selected-flag {
    height: 100%;
    padding: 0 8px;
    display: flex;
    align-items: center;
  }

  /* dropdown arrow */
  .iti__arrow {
    margin-left: 6px;
  }

  /* focus */
  .iti input:focus {
    border-color: #fb923c; /* orange-400 */
    box-shadow: 0 0 0 2px rgba(251,146,60,0.3);
  }

</style>
</head>
<body>

  <style>
.faq-content {
  overflow: hidden;
  transition: max-height 0.35s ease;
}

.faq-btn i {
  transition: transform 0.3s ease;
}
</style>

{% include 'includes/header.html' %}

{% block content %}{% endblock %}



<div id="planRequestModal" class="fixed inset-0 bg-black/60 hidden z-50 flex items-center justify-center">

  <div class="bg-white w-[92%] max-w-md p-6 relative shadow-2xl">

    <button onclick="closePlanRequestModal()" class="absolute top-4 right-4 bg-gray-100 w-8 h-8 flex items-center justify-center">
      <i class="fa-solid fa-xmark"></i>
    </button>

    <div class="mb-6 pb-3 border-b-2 border-orange-400">
      <h3 class="text-lg font-bold text-gray-800">Request Floor Plan</h3>
      <p class="text-sm text-gray-500">For <span id="planTitle" class="font-semibold text-orange-600"></span></p>
    </div>

    <form onsubmit="return submitPlanRequest()" class="space-y-4">

      <input type="text" required placeholder="Full Name" class="w-full border px-3 py-2 text-sm">
      <input type="email" required placeholder="Email" class="w-full border px-3 py-2 text-sm">

      <input type="tel" required placeholder="Mobile Number"
        class="phone-input w-full border px-3 py-2 text-sm">

      <button type="submit" class="w-full bg-orange-500 text-white py-3">Submit & View Plan</button>

    </form>

  </div>
</div>

<div id="configModal" class="fixed inset-0 bg-black/60 hidden z-50 flex items-center justify-center">
  <div class="bg-white w-[92%] max-w-md p-6 relative shadow-2xl">

    <button type="button" onclick="closeConfigModal()" class="absolute top-4 right-4 bg-gray-100 w-8 h-8 flex items-center justify-center hover:bg-gray-200">
      <i class="fa-solid fa-xmark"></i>
    </button>

    <div class="mb-6 pb-3 border-b-2 border-orange-400">
      <h3 class="text-lg font-bold text-gray-800">Get Configuration Details</h3>
      <p class="text-sm text-gray-500">For <span id="selectedBHK" class="text-orange-600 font-semibold">--</span></p>
    </div>

    <form method="post" action="{% url 'response:configuration' %}" class="space-y-4">
      {% csrf_token %}

      <input type="hidden" name="configuration" id="modalConfigInput">

      <input type="text" name="name" required placeholder="Full Name" class="w-full border px-3 py-2 text-sm">
      <input type="email" name="email" required placeholder="Email" class="w-full border px-3 py-2 text-sm">
      <input type="tel" name="phone" maxlength="10" required placeholder="Mobile Number" class="w-full border px-3 py-2 text-sm">

      <button type="submit" class="w-full bg-orange-500 text-white py-3 hover:bg-orange-600 transition">
        Submit & Get Details
      </button>
    </form>
  </div>
</div>

<div id="visitModal" class="fixed inset-0 bg-black/60 hidden z-50 flex items-center justify-center">

  <div class="bg-white w-[92%] max-w-md p-6 relative shadow-2xl">

    <button onclick="closeVisitModal()"
      class="absolute top-4 right-4 bg-gray-100 w-8 h-8 flex items-center justify-center">
      <i class="fa-solid fa-xmark"></i>
    </button>

    <h3 class="text-lg font-bold mb-4">Schedule Site Visit</h3>

     <form method="post" action="{% url 'response:additional_info' %}" class="space-y-4">
      {% csrf_token %}

      <input type="hidden" name="type" value="book_visit">

      <input type="text" name="name" placeholder="Full Name"
        class="w-full border px-3 py-2 text-sm" required>

      <input type="tel" name="phone" placeholder="Mobile Number"
        class="phone-input w-full border px-3 py-2 text-sm" required>

      <p class="phone-error text-red-500 text-xs hidden">
        Please enter a valid mobile number
      </p>


        

      <input type="date" name="visit_date"
        class="w-full border px-3 py-2 text-sm" required>

      <button class="w-full bg-orange-500 text-white py-3">
        Book Visit
      </button>
    </form>


  </div>
</div>


<div id="priceModal" class="fixed inset-0 bg-black/60 hidden z-50 flex items-center justify-center">

  <div class="bg-white w-[92%] max-w-md p-6 relative shadow-2xl">

    <button onclick="closePriceModal()"
      class="absolute top-4 right-4 bg-gray-100 w-8 h-8 flex items-center justify-center">
      <i class="fa-solid fa-xmark"></i>
    </button>

    <h3 class="text-lg font-bold mb-4">Get Price Details</h3>

    <form method="post" action="{% url 'response:additional_info' %}" class="space-y-4">
      {% csrf_token %}

      <input type="hidden" name="type" value="get_price">

      <input type="text" name="name" placeholder="Full Name"
        class="w-full border px-3 py-2 text-sm" required>

      <input type="tel" name="phone" placeholder="Mobile Number"
        class="phone-input w-full border px-3 py-2 text-sm" required>

      <p class="phone-error text-red-500 text-xs hidden">
        Please enter a valid mobile number
      </p>


      <button class="w-full bg-orange-500 text-white py-3">
          Get Price
      </button>
    </form>


  </div>
</div>


<script src="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/18.2.1/js/intlTelInput.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/18.2.1/js/utils.js"></script>

<script>
  document.querySelectorAll(".phone-input").forEach(input => {
    const iti = window.intlTelInput(input, {
      initialCountry: "auto",
      separateDialCode: true,
      utilsScript: "https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/18.2.1/js/utils.js",
      geoIpLookup: cb => fetch("https://ipapi.co/json").then(r=>r.json()).then(d=>cb(d.country_code)).catch(()=>cb("IN"))
    });
  });
</script>

<script>
  function openVisitModal(){
    document.getElementById("visitModal").classList.remove("hidden");
  }
  function closeVisitModal(){
    document.getElementById("visitModal").classList.add("hidden");
  }

  function openPriceModal(){
    document.getElementById("priceModal").classList.remove("hidden");
  }
  function closePriceModal(){
    document.getElementById("priceModal").classList.add("hidden");
  }
</script>


<script>
function openConfigModal(btn){
  // 1. Button se Data nikaalo
  const bhk = btn.getAttribute('data-bhk');
  
  // Debugging: Console check karein agar value na aaye
  console.log("Saving Configuration:", bhk);

  // 2. UI Update (Modal Text)
  document.getElementById("selectedBHK").innerText = bhk;

  // 3. Backend Input Update (Jo Hidden field hai)
  const hiddenInput = document.getElementById("modalConfigInput");
  if(hiddenInput){
      hiddenInput.value = bhk;
  }

  // 4. Modal Open
  document.getElementById("configModal").classList.remove("hidden");
}

function closeConfigModal(){
  document.getElementById("configModal").classList.add("hidden");
}
</script>

<script>
let itiInstances = [];

function initPhoneValidation() {
  itiInstances = [];

  document.querySelectorAll(".phone-input").forEach(input => {

    const iti = window.intlTelInput(input, {
      initialCountry: "auto",
      separateDialCode: true,
      nationalMode: false,
      utilsScript:
        "https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/18.2.1/js/utils.js",
      geoIpLookup: cb => {
        fetch("https://ipapi.co/json/")
          .then(res => res.json())
          .then(data => cb(data.country_code))
          .catch(() => cb("IN"));
      }
    });

    itiInstances.push({ input, iti });

    // live validation
    input.addEventListener("input", () => {
      validatePhoneInput(input, iti);
    });
  });
}

function validatePhoneInput(input, iti) {
  const errorEl = input.nextElementSibling;

  if (input.value.trim() === "") {
    errorEl.classList.add("hidden");
    return false;
  }

  if (iti.isValidNumber()) {
    errorEl.classList.add("hidden");
    input.classList.remove("border-red-500");
    return true;
  } else {
    errorEl.classList.remove("hidden");
    input.classList.add("border-red-500");
    return false;
  }
}

/* üî• FORM SUBMIT BLOCK */
document.querySelectorAll("form").forEach(form => {
  form.addEventListener("submit", function (e) {

    let valid = true;

    itiInstances.forEach(obj => {
      if (form.contains(obj.input)) {
        if (!validatePhoneInput(obj.input, obj.iti)) {
          valid = false;
        }
      }
    });

    if (!valid) {
      e.preventDefault(); // ‚ùå stop submit
    }
  });
});

/* init on load */
document.addEventListener("DOMContentLoaded", initPhoneValidation);
</script>

<script>
document.addEventListener("input", function (e) {
  if (e.target.classList.contains("phone-input")) {
    e.target.value = e.target.value.replace(/\D/g, "").slice(0, 10);
  }
});
</script>

<script>
document.addEventListener("DOMContentLoaded", () => {

  const faqButtons = document.querySelectorAll(".faq-btn");

  faqButtons.forEach(btn => {

    const content = btn.nextElementSibling;
    const icon = btn.querySelector("i");

    // Accessibility
    btn.setAttribute("aria-expanded", "false");
    content.setAttribute("aria-hidden", "true");

    btn.addEventListener("click", () => {

      const isOpen = btn.getAttribute("aria-expanded") === "true";

      // Close all others (Accordion behavior)
      faqButtons.forEach(otherBtn => {
        if (otherBtn !== btn) {
          closeFAQ(otherBtn);
        }
      });

      // Toggle current
      isOpen ? closeFAQ(btn) : openFAQ(btn);
    });

    function openFAQ(button) {
      const panel = button.nextElementSibling;
      const iconEl = button.querySelector("i");

      panel.classList.remove("hidden");
      panel.style.maxHeight = panel.scrollHeight + "px";

      iconEl.classList.remove("fa-plus");
      iconEl.classList.add("fa-minus", "rotate-180");

      button.setAttribute("aria-expanded", "true");
      panel.setAttribute("aria-hidden", "false");
    }

    function closeFAQ(button) {
      const panel = button.nextElementSibling;
      const iconEl = button.querySelector("i");

      panel.style.maxHeight = null;
      setTimeout(() => panel.classList.add("hidden"), 200);

      iconEl.classList.add("fa-plus");
      iconEl.classList.remove("fa-minus", "rotate-180");

      button.setAttribute("aria-expanded", "false");
      panel.setAttribute("aria-hidden", "true");
    }

  });

});
</script>


<footer class="bg-gray-600 text-gray-400 text-xs bottom-0 w-full mt-10">
  <div class="max-w-7xl mx-auto px-4 py-3">

    <div class="flex flex-col md:flex-row items-center justify-between gap-2 text-center md:text-left">

      <!-- LEFT : COPYRIGHT -->
      <div>
        ¬© <span id="year"></span>
        <span class="text-gray-300 font-medium">
          {{ settings_obj.copy_right }}
        </span>. All rights reserved.
      </div>

      <!-- CENTER : LINKS -->
      <nav class="flex items-center gap-3">
        <a href="{% url 'privacy-policy' %}" class="hover:text-orange-400 transition">
          Privacy Policy
        </a>
        <span class="text-white hidden sm:inline">|</span>
        <a href="{% url 'terms_conditions' %}" class="hover:text-orange-400 transition">
          Terms & Conditions
        </a>
      </nav>

      <!-- RIGHT : CREDIT -->
      <div>
        Created by
        <span class="text-orange-400 font-medium">
          Renuka Tiwari
        </span>
      </div>

    </div>

  </div>
</footer>


<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

</body>
</html>
